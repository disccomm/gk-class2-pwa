<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>GK Quiz ‚Äì Class 2</title>

<style>
body { font-family: system-ui, -apple-system; background:#f4f6f8; margin:0; }
header { background:#2563eb; color:#fff; padding:14px; text-align:center; }
.container { max-width:720px; margin:auto; padding:14px; }
.card { background:#fff; border-radius:14px; padding:16px; box-shadow:0 6px 18px rgba(0,0,0,.08); }

.progress { height:8px; background:#e5e7eb; border-radius:4px; overflow:hidden; margin:8px 0; }
.bar { height:100%; width:0%; background:#2563eb; }

.option {
  border:1px solid #d1d5db; border-radius:10px;
  padding:14px; margin:8px 0; font-size:16px;
}
.option.selected { background:#dbeafe; border-color:#2563eb; }

.actions-row {
  display:flex; justify-content:space-between; margin:12px 0;
}
.actions-row span { font-size:18px; cursor:pointer; }

.nav {
  display:flex; justify-content:space-between; gap:10px;
}
button {
  flex:1; padding:14px; border:none; border-radius:10px;
  font-size:16px;
}
.primary { background:#2563eb; color:white; }
.secondary { background:#9ca3af; color:white; }
.disabled { opacity:.4; pointer-events:none; }

img { max-width:100%; border-radius:10px; margin:10px 0; }

.modal {
  position:fixed; inset:0; background:rgba(0,0,0,.4);
  display:none; align-items:center; justify-content:center;
}
.modal .box {
  background:#fff; padding:20px; border-radius:12px; width:80%;
}

.review-card { margin-bottom:14px; padding-bottom:10px; border-bottom:1px solid #e5e7eb; }
</style>
</head>

<body>

<header>
  <h2>GK Quiz ‚Äì Class 2</h2>
</header>

<div class="container">

<div class="card" id="setup">
  <p><b>How many questions?</b></p>
  <label><input type="radio" name="count" value="5"> 5</label>
  <label><input type="radio" name="count" value="10" checked> 10</label>
  <label><input type="radio" name="count" value="20"> 20</label>
  <label><input type="radio" name="count" value="50"> 50</label>
  <br><br>
  <button class="primary" onclick="startQuiz()">Start Quiz</button>
</div>

<div class="card" id="quiz" style="display:none;">
  <div style="display:flex; justify-content:space-between;">
    <span id="qnum"></span>
    <span onclick="confirmExit()">Exit ‚úñ</span>
  </div>

  <div class="progress"><div class="bar" id="bar"></div></div>

  <p id="question"></p>
  <div id="image"></div>
  <div id="options"></div>

  <div class="actions-row">
    <span onclick="clearAnswer()">üßΩ Clear</span>
    <span onclick="skip()">‚è≠ Skip</span>
  </div>

  <div class="nav">
    <button class="secondary" onclick="prev()">‚Üê Previous</button>
    <button id="nextBtn" class="primary disabled" onclick="next()">Next ‚Üí</button>
  </div>
</div>

<div class="card" id="summary" style="display:none;"></div>

</div>

<div class="modal" id="exitModal">
  <div class="box">
    <p><b>Exit Quiz?</b><br>Your progress will be saved.</p>
    <button class="secondary" onclick="closeExit()">Cancel</button>
    <button class="primary" onclick="exitQuiz()">Exit Quiz</button>
  </div>
</div>

<script src="questionBank.js"></script>
<script>
let quiz=[], idx=0, answers={}, skipped={};

function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }

function startQuiz(){
  const n = document.querySelector('input[name="count"]:checked').value;
  quiz = shuffle(QUESTION_BANK).slice(0,n).map(q=>({...q, opts:shuffle(q.options)}));
  setup.style.display="none"; quizDiv.style.display="block";
  render();
}

const quizDiv = document.getElementById("quiz");

function render(){
  const q = quiz[idx];
  qnum.innerText = `Question ${idx+1} of ${quiz.length}`;
  bar.style.width = ((idx+1)/quiz.length*100)+"%";
  question.innerText = q.question;

  image.innerHTML = "";
  if(q.type==="image") image.innerHTML=`<img src="${q.imageUrl}">`;

  options.innerHTML="";
  q.opts.forEach((o,i)=>{
    const d=document.createElement("div");
    d.className="option"+(answers[idx]===o?" selected":"");
    d.innerText=String.fromCharCode(65+i)+". "+o;
    d.onclick=()=>select(o);
    options.appendChild(d);
  });

  nextBtn.classList.toggle("disabled", !answers[idx]);
}

function select(o){
  answers[idx]=o; delete skipped[idx]; render();
}

function clearAnswer(){ delete answers[idx]; render(); }

function skip(){ skipped[idx]=true; next(); }

function next(){
  if(idx<quiz.length-1){ idx++; render(); }
  else showSummary();
}

function prev(){ if(idx>0){ idx--; render(); } }

function confirmExit(){ exitModal.style.display="flex"; }
function closeExit(){ exitModal.style.display="none"; }

function exitQuiz(){ exitModal.style.display="none"; showSummary(); }

function showSummary(){
  quizDiv.style.display="none";
  summary.style.display="block";

  let correct=0, wrong=0, skipCount=0;
  quiz.forEach((q,i)=>{
    if(skipped[i]) skipCount++;
    else if(answers[i]===q.answer) correct++;
    else if(answers[i]) wrong++;
  });

  summary.innerHTML=`
    <h3>Quiz Summary</h3>
    <p>Score: ${correct} / ${quiz.length}</p>
    <p>‚úî Correct: ${correct} | ‚úò Wrong: ${wrong} | ‚è≠ Skipped: ${skipCount}</p>
    <hr>
  `;

  quiz.forEach((q,i)=>{
    summary.innerHTML+=`
      <div class="review-card">
        <b>Q${i+1}. ${q.question}</b><br>
        Your answer: ${answers[i]||"Not Answered"}<br>
        Correct answer: <b>${q.answer}</b><br>
        üìò Page ${q.page}
      </div>`;
  });
}
</script>

</body>
</html>