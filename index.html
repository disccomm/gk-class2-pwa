<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>GK Quiz ‚Äì Engine Validation</title>

<style>
body { font-family: Arial, sans-serif; background:#f4f6f8; margin:0; }
header { background:#2563eb; color:#fff; padding:16px; text-align:center; }
.card { background:#fff; margin:16px; padding:16px; border-radius:12px; }
button { padding:12px; border:none; border-radius:8px; font-size:16px; }
.primary { background:#2563eb; color:#fff; }
.secondary { background:#e5e7eb; }
.option { border:1px solid #ccc; padding:12px; border-radius:8px; margin-top:8px; cursor:pointer; }
.option.correct { background:#dcfce7; border-color:#22c55e; }
.option.wrong { background:#fee2e2; border-color:#ef4444; }
.option.selected { background:#dbeafe; }
img { max-width:100%; border-radius:8px; margin:12px 0; }
.row { display:flex; gap:12px; margin-top:12px; }
.hidden { display:none; }
.disabled { opacity:0.5; pointer-events:none; }
</style>
</head>

<body>

<header>GK Quiz ‚Äì Engine Validation</header>

<div class="card" id="startScreen">
  <h3>How many questions?</h3>
  <label><input type="radio" name="count" value="5" checked> 5</label>
  <label style="margin-left:12px"><input type="radio" name="count" value="10"> 10</label>
  <br><br>
  <button class="primary" onclick="startQuiz()">Start Quiz</button>
</div>

<div class="card hidden" id="quizScreen">
  <div><b id="progress"></b> <span style="float:right;cursor:pointer" onclick="exitQuiz()">Exit ‚úï</span></div>
  <hr>
  <div id="questionText"></div>
  <img id="questionImage" class="hidden"/>
  <div id="options"></div>

  <div class="row">
    <button id="clearBtn" class="secondary" onclick="clearSelection()">üßΩ Clear</button>
    <button class="secondary" onclick="skip()">‚è≠ Skip</button>
  </div>

  <div class="row">
    <button class="secondary" onclick="prev()">‚Üê Previous</button>
    <button id="nextBtn" class="primary disabled" onclick="next()">Next ‚Üí</button>
  </div>
</div>

<div class="card hidden" id="summaryScreen"></div>

<script src="questionBank.js"></script>

<script>
let quiz=[], index=0, answers={};

function startQuiz(){
  const count = +document.querySelector('input[name="count"]:checked').value;
  quiz = [...QUESTION_BANK].sort(()=>0.5-Math.random()).slice(0,count);
  index=0; answers={};
  document.getElementById('startScreen').classList.add('hidden');
  document.getElementById('quizScreen').classList.remove('hidden');
  render();
}

function render(){
  const q=quiz[index];
  document.getElementById('progress').innerText=`Question ${index+1} of ${quiz.length}`;
  document.getElementById('questionText').innerText=q.question;

  const img=document.getElementById('questionImage');
  if(q.image){ img.src=q.image; img.classList.remove('hidden'); }
  else img.classList.add('hidden');

  const opts=document.getElementById('options');
  opts.innerHTML="";
  q.options.forEach((o,i)=>{
    const d=document.createElement('div');
    d.className='option';
    d.innerText=String.fromCharCode(65+i)+". "+o;
    d.onclick=()=>select(o,d);
    opts.appendChild(d);
  });

  document.getElementById('nextBtn').classList.add('disabled');
  document.getElementById('clearBtn').classList.remove('disabled');
}

function select(val,el){
  if(answers[index]) return;
  answers[index]=val;
  document.getElementById('nextBtn').classList.remove('disabled');
  document.getElementById('clearBtn').classList.add('disabled');

  [...document.querySelectorAll('.option')].forEach(o=>{
    if(o.innerText.includes(quiz[index].answer)) o.classList.add('correct');
    else if(o===el) o.classList.add('wrong');
  });
}

function clearSelection(){
  if(answers[index]) return;
  render();
}

function next(){
  if(index<quiz.length-1){ index++; render(); }
  else showSummary();
}

function prev(){ if(index>0){ index--; render(); } }

function skip(){ index++; if(index<quiz.length) render(); else showSummary(); }

function exitQuiz(){ showSummary(); }

function showSummary(){
  document.getElementById('quizScreen').classList.add('hidden');
  const s=document.getElementById('summaryScreen');
  s.classList.remove('hidden');
  let correct=0;
  s.innerHTML="<h3>Quiz Review</h3>";
  quiz.forEach((q,i)=>{
    const ok=answers[i]===q.answer;
    if(ok) correct++;
    s.innerHTML+=`<p><b>Q${i+1}:</b> ${q.question}<br>
    Your answer: ${answers[i]||"Skipped"}<br>
    Correct: ${q.answer} (PDF page ${q.page})</p><hr>`;
  });
  s.innerHTML+=`<b>Score:</b> ${correct}/${quiz.length}<br>
  <button class="primary" onclick="location.reload()">Restart</button>`;
}
</script>
</body>
</html>