<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>GK Quiz</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #f2f4f8;
}

header {
  background: #2563eb;
  color: white;
  padding: 16px;
  text-align: center;
  font-size: 20px;
  font-weight: bold;
}

.card {
  max-width: 700px;
  margin: 20px auto;
  background: white;
  border-radius: 12px;
  padding: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,.08);
}

button {
  padding: 12px 16px;
  border-radius: 10px;
  border: none;
  font-size: 16px;
  cursor: pointer;
}

button.primary { background:#2563eb; color:white }
button.secondary { background:#e5e7eb }
button:disabled { opacity:.5; cursor:not-allowed }

.option {
  border: 2px solid #e5e7eb;
  padding: 14px;
  border-radius: 12px;
  margin-bottom: 10px;
  cursor: pointer;
}

.option.correct { background:#dcfce7; border-color:#22c55e }
.option.wrong { background:#fee2e2; border-color:#ef4444 }

img {
  max-width: 100%;
  border-radius: 12px;
  margin: 10px 0;
}

.controls {
  display:flex;
  gap:10px;
  flex-wrap:wrap;
}

.review-item {
  border-bottom:1px solid #e5e7eb;
  padding:10px 0;
}

.review-wrong { color:#dc2626; font-weight:bold }
.review-correct { color:#16a34a; font-weight:bold }

@media(max-width:600px){
  .card { margin:10px }
}
</style>
</head>

<body>

<header>GK Quiz</header>

<div class="card" id="startScreen">
  <h3>How many questions?</h3>
  <label><input type="radio" name="count" value="5"> 5</label><br>
  <label><input type="radio" name="count" value="10" checked> 10</label><br>
  <label><input type="radio" name="count" value="15"> 15</label><br>
  <br>
  <button class="primary" onclick="startQuiz()">Start Quiz</button>
</div>

<div class="card" id="quizScreen" style="display:none">
  <div id="progress"></div>
  <h3 id="questionText"></h3>
  <img id="questionImage" style="display:none" />
  <div id="options"></div>

  <div class="controls">
    <button class="secondary" id="clearBtn" onclick="clearSelection()">Clear</button>
    <button class="secondary" onclick="nextQuestion()" id="nextBtn" disabled>Next â†’</button>
  </div>
</div>

<div class="card" id="reviewScreen" style="display:none">
  <h3>Quiz Review</h3>
  <div id="review"></div>
  <button class="primary" onclick="location.reload()">Restart</button>
</div>

<script src="questionBank.js"></script>

<script>
let questions=[], current=0, answers={}, locked=false;

function startQuiz(){
  if(!window.questionBank){ alert("Question Bank not loaded"); return; }

  const max=window.questionBank.length;
  const count=[...document.querySelectorAll('input[name=count]')]
    .find(r=>r.checked).value;
  questions=[...window.questionBank].slice(0, Math.min(count,max));

  document.getElementById('startScreen').style.display='none';
  document.getElementById('quizScreen').style.display='block';
  render();
}

function render(){
  locked=false;
  document.getElementById('nextBtn').disabled=true;
  document.getElementById('clearBtn').disabled=false;

  const q=questions[current];
  document.getElementById('progress').innerText=
    `Question ${current+1} of ${questions.length}`;
  document.getElementById('questionText').innerText=q.question;

  const img=document.getElementById('questionImage');
  if(q.image){
    img.src=`images/${q.image}`;
    img.style.display='block';
  } else img.style.display='none';

  const opts=document.getElementById('options');
  opts.innerHTML='';
  q.options.forEach(opt=>{
    const d=document.createElement('div');
    d.className='option';
    d.innerText=opt;
    d.onclick=()=>select(opt,d);
    opts.appendChild(d);
  });
}

function select(ans,el){
  if(locked) return;
  locked=true;
  answers[current]=ans;
  document.getElementById('nextBtn').disabled=false;
  document.getElementById('clearBtn').disabled=true;

  [...document.querySelectorAll('.option')].forEach(o=>{
    if(o.innerText===questions[current].correctAnswer) o.classList.add('correct');
    else if(o===el) o.classList.add('wrong');
  });
}

function clearSelection(){
  if(locked) return;
  answers[current]=null;
  render();
}

function nextQuestion(){
  if(++current<questions.length) render();
  else showReview();
}

function showReview(){
  document.getElementById('quizScreen').style.display='none';
  document.getElementById('reviewScreen').style.display='block';

  const r=document.getElementById('review');
  r.innerHTML='';
  questions.forEach((q,i)=>{
    const div=document.createElement('div');
    div.className='review-item';
    div.innerHTML=`
      <div>${i+1}. ${q.question}</div>
      <div class="${answers[i]===q.correctAnswer?'review-correct':'review-wrong'}">
        Your answer: ${answers[i]||'Skipped'}
      </div>
      <div class="review-correct">
        Correct: ${q.correctAnswer}
      </div>
    `;
    r.appendChild(div);
  });
}
</script>

</body>
</html>
