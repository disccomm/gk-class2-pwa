<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>GK Quiz ‚Äì Engine Validation</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
  body { font-family: system-ui; margin: 0; background:#f4f7fb; }
  header { background:#2563eb; color:white; padding:16px; text-align:center; font-size:20px; }
  .card { background:white; margin:16px; padding:16px; border-radius:12px; }
  .progress { height:6px; background:#e5e7eb; border-radius:4px; overflow:hidden; }
  .progress div { height:100%; background:#2563eb; }
  .option {
    border:1px solid #d1d5db; padding:12px; border-radius:8px;
    margin-top:8px; cursor:pointer;
  }
  .correct { background:#dcfce7; border-color:#22c55e; }
  .wrong { background:#fee2e2; border-color:#ef4444; }
  .disabled { pointer-events:none; opacity:0.6; }
  img { max-width:100%; border-radius:8px; margin:12px 0; }
  .row { display:flex; justify-content:space-between; gap:8px; margin-top:12px; }
  button {
    flex:1; padding:12px; border:none; border-radius:8px;
    font-size:16px; cursor:pointer;
  }
  .primary { background:#2563eb; color:white; }
  .secondary { background:#9ca3af; color:white; }
</style>
</head>

<body>
<header>GK Quiz ‚Äì Engine Validation</header>

<div class="card" id="setup">
  <p><strong>How many questions?</strong></p>
  <label><input type="radio" name="count" value="5" checked> 5</label>
  <label style="margin-left:12px;"><input type="radio" name="count" value="10"> 10</label>
  <div style="margin-top:12px;">
    <button class="primary" onclick="startQuiz()">Start Quiz</button>
  </div>
</div>

<div class="card" id="quiz" style="display:none;">
  <div class="row">
    <div id="qcount"></div>
    <div><button onclick="exitQuiz()">Exit ‚úï</button></div>
  </div>
  <div class="progress"><div id="bar"></div></div>

  <p id="question"></p>
  <img id="qimg" style="display:none;" />

  <div id="options"></div>

  <div class="row">
    <button onclick="clearAnswer()">üßΩ Clear</button>
    <button onclick="skip()">‚è≠ Skip</button>
  </div>

  <div class="row">
    <button class="secondary" onclick="prev()">‚Üê Previous</button>
    <button class="primary" id="nextBtn" onclick="next()" disabled>Next ‚Üí</button>
  </div>
</div>

<div class="card" id="summary" style="display:none;"></div>

<script src="questionBank.js"></script>
<script>
let quiz=[], index=0, answers={};

function shuffle(a){ return [...a].sort(()=>Math.random()-0.5); }

function startQuiz(){
  const n = +document.querySelector('input[name="count"]:checked').value;
  quiz = shuffle(QUESTION_BANK).slice(0,n);
  index = 0; answers = {};
  setup.style.display="none"; quizEl.style.display="block";
  render();
}

const quizEl = document.getElementById("quiz");

function render(){
  const q = quiz[index];
  qcount.innerText = `Question ${index+1} of ${quiz.length}`;
  bar.style.width = ((index+1)/quiz.length*100)+"%";
  question.innerText = q.question;

  if(q.image){
    qimg.src = q.image;
    qimg.style.display="block";
  } else qimg.style.display="none";

  options.innerHTML="";
  nextBtn.disabled = !answers[q.id];

  shuffle(q.options).forEach((opt,i)=>{
    const div=document.createElement("div");
    div.className="option";
    div.innerText = String.fromCharCode(65+i)+". "+opt;

    if(answers[q.id]){
      div.classList.add("disabled");
      if(opt===q.answer) div.classList.add("correct");
      if(answers[q.id]===opt && opt!==q.answer) div.classList.add("wrong");
    }

    div.onclick=()=>{
      if(answers[q.id]) return;
      answers[q.id]=opt;
      render();
    };
    options.appendChild(div);
  });
}

function clearAnswer(){
  const q=quiz[index];
  if(!answers[q.id]) return;
  delete answers[q.id];
  render();
}

function skip(){ next(); }
function next(){ if(index<quiz.length-1){ index++; render(); } else showSummary(); }
function prev(){ if(index>0){ index--; render(); } }

function exitQuiz(){ showSummary(); }

function showSummary(){
  quizEl.style.display="none";
  summary.style.display="block";
  let correct=0, html="<h3>Quiz Summary</h3>";
  quiz.forEach((q,i)=>{
    const ua = answers[q.id]||"Not Answered";
    if(ua===q.answer) correct++;
    html+=`<p><b>Q${i+1}:</b> ${q.question}<br>
    Your answer: ${ua}<br>
    Correct: ${q.answer}<br>
    Source: ${q.source}</p><hr>`;
  });
  html+=`<p><b>Score:</b> ${correct} / ${quiz.length}</p>`;
  summary.innerHTML=html;
}
</script>
</body>
</html>